# ROS核心概念和常用命令行工具

## 核心概念

### 通信机制

+ 松耦合分布式通信的方式

### 节点和节点管理器

+ 节点（Node）——执行单元
  + 执行具体的任务进程，独立运行的可执行文件
  + 不同几点编程语言可以不一样
  + 节点名称必须一样
+ 节点管理器（ROS Master）——控制中心
  + 为节点提供命名和注册服务
  + 跟踪和记录话题/服务通信，辅助节点相互查找、建立连接
  + 提供参数服务器，节点使用此服务器存贮和检索运行时的参数

### 话题通信

+ 话题（Topic）——异步通信
  + 几点传输数据的总线
  + 使用发布/订阅模型，数据有发布者传输到订阅者，同一话题的订阅者或者发布者可以不唯一
+ 消息（Message）——话题数据
  + 具有一定的类型和数据结构，包括ROS提供的标准类型和用户自定义类型
  + 使用编程语言无关的.msg文件定义，编译过程中生成对应的代码文件。

![1](img\1.png)

### 服务通信

+ 服务（Service）——同步通信机制

  + 使用*客户端/服务器*（C/S）模型，客户端发送请求数据，服务器完成
    处理后返回应答数据；
  + 使用编程语言无关的`.srv`文件定义请求和应答数据结构，编译过程中
    生成对应的代码文件。

  ![2](img\2.png)

### 参数

+ 参数（Parameter）——全局共享字典
  + 可通过网络访问的*共享*、多变量*字典*；
  + 节点使用此服务器来存储和检索*运行时的参数*；
  +  适合存储静态、非二进制的*配置参数*，不适合存储动态配置的数据。

### 文件系统

+ 功能包（Package）

  + ROS软件的基本单元、包含节点源码、配置文件、数据定义

+ 功能包清单（Package manifest）

  + 记录功能包的基本信息，包含作者信息、许可信息、依赖选项、编译标志等

+ 元功能包（Meta Packages）

  + 组织用于同一目的的功能包

  ![3](img\3.png)

## 命令行工具使用

+ 常用命令

```C
rostopic
rosservice
rosnode
rosparam
rosmsg
rossrv
```

+ 工具`rqt_graph`：显示系统计算图

+ **rosnode**

  + 显示节点相关信息的指令

  + 可接参数
    + ```C
      list  //将节点列出来
      info /节点名   // 查看某个节点的相关信息
      ```

+ **rostopic**

  + 话题信息

  + 可接参数

    + ```C
      list  //打印所有话题列表
      pub -r 10 /话题名/cmd_vel 消息结构 "结构数据"//发布话题指令
      ```

+ **rosmsg show 消息结构名**    查看数据结构类型

+ **rosservice** 和**rostopic** 一样

+ **rosbag record -a -o 文件名**：记录话题信息

+ **rosbag play 文件名**：执行记录的话题信息


# 第二章、网络应用（应用层）

[toc]

## 一、网络体系结构

​		你对网络应用结构肯定非常疑惑，我不是要学应用层协议吗，为啥上来给我讲这个网络应用结构？这个网络应用结构到底是什么东西？它的作用是什么？学了有啥帮助吗？下面我来好好的讲解一下有关这个网络应用结构吧。

​		其实网络应用结构，是APP之间，根据数据交互方式的不同而建立起来的通信结构。总结下来就是三种通信结构：客户服务器结构（`C/S`）、对等结构（`P2P`）、混合结构（也叫混合结构）。

### 1. C/S

​		在介绍`C/S`结构之前我得先介绍两个概念，什么是服务器，什么叫客户端。先简单的说一下什么是服务器吧，英文名叫`Server`。服务服务，名如其功能，服务器就是给我们提供服务的一种设备。举个栗子：如我们看电视的时候，用的APP，他里面的数据不是凭空出现的，而是我们向，给我们提供服务的设备，发送请求消息后，设备下发给我们的。这种设备我们可以称之为服务器。对应的，询问数据的我们就是那个C咯，我们称之为客户端，英文名叫`Client`。现在理解什么是`C/S`客户服务器结构了吧，这就是说的其中一种通信方式。其实最直观的并不是这个栗子，而是Web应用，看下图。

![1](img\1.png)

简单讲解一下他们之间的特点：

**服务器：**

+ 7*24小时提供服务
+ 永久性访问地址/域名
+ 利用大量服务器实现可扩展性

**客户机：**

+ 与服务器通信，使用服务器提供的服务
+ 间歇性接入网络
+ 可能使用动态IP地址
+ 不会与其他客户机直接通信

### 2. P2P

​		有了上一个通信结构的基础，相信，P2P结构你会更好理解的，P2P指Peer to Peer结构，我们这里称之为对等结构。什么叫对等呢，就是点对点的通信方式，抛开其它层的协议，点对点的数据交互的方式我们称之为对等的通信结构。

<img src="img\2.png" alt="2" style="zoom:50%;" />

**特点：**

+ 没有永远在线的服务器
+ 任意端系统/节点之间可以直接通讯
+ 节点间歇性接入网络
+ 节点可能改变IP地址

### 3. 混合结构

​		混合结构就是结合了`C/S`和`P2P`两者的特点，而定义的一种通信结构。典型的应用`Napster`。

## 二、进程间通信

### 1. 进程

​		先简单介绍一下什么是进程，进程就是主机上运行的程序，我们简称为进程，你们同一主机上运行的进程的通信方式，我们称之为管道，想要细致了解的可以去看看进程间通信的内容，在操作系统部分有讲。那么问题来了，不同主机间的进程又是怎么通信的呢，这个时候你是不是已经想到了网络通信呢，我想你应该想到了。

​		没错不同主机间进行数据交换的方式就是网络通信。他这种通信方式分为三种，在上面的`网络体系结构`中我们已经讲到了。这里简单的举个栗子，`C/S`结构：客户机进程（发起通信的进程）、服务器进程（等待通信请求的进程）。

​		知道了什么是进程，你还得知道，在应用层是怎么将数据打包的吧，这个时候你就得知道另一个东西，那就是最后会讲到的`Socket`套接字，`Socket`套接字其实就是，将你想要发送的数据包装起来的一种方式。（后面会讲）

​		在知道了数据包装的形式之后，是不是要将数据发送出去。这个时候问题来了，在偌大的网络中，我如何寻找到，我想要发送到的目的主机的进程上呢？有此疑问，那真的是太好了，说你看懂了上面的内容，可以继续往下看了。下面我来讲解一下计算机是如何找到我想要通信的主机上对应的进程的。

​		下面是重点：（但是只需要先知道就行，在后面的传输层会细致的讲到）

1. 如何寻找主机？---`IP地址`

​        正如你所想的那样，不同主机之间是通过查找`IP地址`的方式，而确定数据的发送方和接收方。你肯定会好奇，啥是`IP地址`吧。别慌，这是后面的内容，目前阶段，你只需要知道是通过`IP地址`确定两台不同主机之间进行通信的就行，`IP地址`在后面的章节会有讲解。

2. 怎么确定进程呢？---`端口号`

​        在通过`IP地址`想要通信的主机之后，我们可以通过确定`端口号`而确定想要通信的进程。

**也就是说：`IP地址+端口号`我们就可以确定是哪两台主机进行通信的。**

​		简单的介绍完进程间通信之后，我们还得了解的就是现在比较流行的==**两种服务结构**==`TCP和UDP`。

```
TCP服务
	面向连接: 客户机/服务器进程间需要建立连接
	可靠的传输
	流量控制: 发送方不会发送速度过快，超过接收方的处理能力
	拥塞控制: 当网络负载过重时能够限制发送方的发送速度
	不提供时间/延迟保障
	不提供最小带宽保障
UDP服务
	无连接
	不可靠的数据传输
	不提供：
		• 可靠性保障
		• 流量控制
		• 拥塞控制
		• 延迟保障
		• 带宽保障
```

## 三、特定网络应用

### 1. Web应用

1. 概述

​		`World Wide Web`:是由`Tim Berners-Lee`这个人发明的，也就是我们大家所熟知的万维网。也可以说是`Web`。`Web`的最基本单元就是网页，为什么叫万维网呢！那是因为，网页与网页之间相互链接。

​		下面说一下网页的构成吧，网页包含了多个对象，这里所说的对象除了最基本的HTML文件外，还有图片，视频文件，或者一些动态脚本文件`CSS`。

2. `URL`---统一资源定位器

​		由于网络上存在很多主机和服务器。所以，当我们要查找某一个指定主机上的资源时，我们就需要用到`URL`它包含了哪些参数呢。

```html
<!-- 由4部分组成：<协议>://<主机>:<端口>/<路径> -->
protocol :// hostname[:port] / path /  <!-- 这就是一个URL -->
<!-- 栗子： -->
http://www.baidu.com/...
```

3. **协议HTTP**

​		知道了什么是`URL`之后，我们得知道用了什么协议吧？大白话就是，数据以什么样的格式进行传输的。

​		`web`遵循的协议一般都是`http`协议，中文名叫超文本传输协议，这种协议所遵循的网络传输架构为`C/S`结构。想必大家都明白的，当你输入一个网址到浏览器中时，回车之后就会显示出对应的搜索内容出来。也就是说，我们所使用的浏览器其实就是客户机，它主要为我们进行数据的请求和接收，然后展示Web对象。而服务器，主要就是响应客户的请求和发送对象。

<img src="img\3.png" alt="3" style="zoom:50%;" />

​		现在比较流行的http协议版本主要分为两类1.0和1.1 对应的RFC文档是1945和2068。

### 2. HTTP协议

1. 基础概念

​		HTTP协议的连接方式有两种，一种是`非持久性连接`、另一种是`持久性连接`。两种连接方式对应着不同的HTTP版本，在1.0版本中默认使用的是非持久性连接，而1.1版本中用到的默认版本是持久性连接。这两种不同的连接方式的不同点在于，非持久性连接最多允许传输一个对象，而持久性连接可以传输多个对象。

![4](img\4.png)

​		持久性连接有分为`无流水的持久性连接`和`带有流水的持久性连接`。

2. 消息类型

​		消息分为`请求消息`和`响应消息`两种类型。消息的书写格式都是以`ASCII`来写的，人是可以直接读的。

![5](img\5.png)

**请求消息**

先上栗子

```html
GET /somedir/page.html HTTP/1.1  <!-- request line -->
Host: www.someschool.edu	<!-- header line -->
User-agent: Mozilla/4.0		<!-- header line -->
Connection: close			<!-- header line -->
Accept-language:fr			<!-- header line -->

(extra carriage return, line feed)	<!-- 通常不用 -->
```

看到`GET`了吧，这里写的是方法类型，不同的HTTP协议有不同的方法类型，不管事1.0还是1.1版本，常用的方法类型有`GET,POST,HEAD（HEAD常用来做测试使用）`。更多的方法类型可以查阅RFC文档了解。

`GET`方法后面跟的是URL，这里其实就是网址，就是需要请求数据的路径。后面加上空格后紧跟所对应的HTTP的版本就行。

使用首部字段是为了给浏览器和服务器提供报文主体大小、所使用的语言、认证信息等内容。这里面的首部行并不一定是必须要的。

**响应消息**

```html
HTTP/1.1 200 OK		<!-- status line -->
Connection: close		<!-- header line -->
Date: Thu, 06 Aug 1998 12:00:15 GMT 
Server: Apache/1.3.0 (Unix) 
Last-Modified: Mon, 22 Jun 1998
Content-Length: 6821 
Content-Type: text/html			<!-- header line -->

data data data data data ...	<!-- data -->
```

响应消息中，首先要包含的内容是版本信息，紧跟状态码，常见的状态码有200、404、400、505...然后就是接头部行和数据

### 3. Cookie和Web缓存技术



### 4. 电子邮件



### 5. DNS系统

​		DNS又叫域名解析系统，就像名字所说的那样，是用来解析域名的，那上面叫域名呢。我这里举个例栗子。

```html
www.baidu.com.
```

​		上面的网址用`.`分开的各个部分就是域名。按从左到右的顺序，域名的等级由低到高，`.`是根，`com`我们称为一级（顶级）域名，`baidu`我们称为二级域名，往后就是三级域名，四级域名。解释可能不是很清楚，上图。

![6](img\6.png)

​		这里我会给个表格，大致说一下各部分域名都有哪些。其中二级域名和三级域名我们都是可以通过申请的方式进行注册的。

| 根           | `.`                   |                                         |
| ------------ | --------------------- | --------------------------------------- |
| **顶级域名** | 国家顶级域名          | `cn,us,uk`                              |
|              | 通用顶级域名          | `com,net,org,gov,int,aero,museum,trave` |
|              | 基础结构域名/反向域名 | `arpa`                                  |
| 二级域名     | 类别域名              | `ac,com,edu,gov,mil,net,org`            |
|              | 行政域名              | `bj,js`                                 |

​		现在应该知道什么是域名了，下面我说一下，他和什么对应吧和为啥要有这个东西。首先我们知道，当我们想要访问其他主机时，需要知道对应的`IP`和端口号，但是`IP`实在太长，不好记，这个时候，就想啊，有没有一个可以我说名字，他就能帮我查到对应的服务器的`IP`的一样东西呢，这个时候，DNS服务器就诞生了。每当我们想要访问某个服务器时，我们只需要知道他对应的网址，那么本地域名解析器就会帮我们进行查找这个网址对应的`IP`。了解到了DNS解析器是干嘛的，那我们得知道有哪些域名服务器吧，看下图。

![7](img\7.png)

​		这里我简单解释一下就是，当我们想要查找某一个网址对应的`IP`的时，并不是那么轻松的。例如，根域名服务器中只能查找到顶级域名服务器的地址，对应的顶级域名服务器中只有权限域名服务器，这样一层套一层。那我在查找我想要的网址对应的`IP`是啥的时候，重要的一点就是要知道查询方式。这里有两种查询方式`迭代式`和`递归式`。

​		上面提到了一个很重要的域名服务器，是本地域名服务器。这是很重要的一个域名服务器，因为我们的网址在查询的过程中，都要先经过本地域名服务器查找无果后才从根域名服务器一直查下去，直到查到有我们IP的域名服务器为止。

​		对于查询方式我上张图，看图你就明白了。

![8](img\8.png)

### 6. 文件传输协议FTP





## 四、Socket编程







